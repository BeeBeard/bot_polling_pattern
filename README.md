# üöÄ Bot-Pattern

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç ‚Äî –±–æ—Ç —à–∞–±–ª–æ–Ω –Ω–∞ python, —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π miniapp

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
üì¶ bot-pattern
 ‚î£ üìÇ app/                   # –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–¥ –±–æ—Ç–∞
 ‚îÉ ‚î£ üìÇ api/                 # API –∏ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
 ‚îÉ ‚îÉ ‚î£ üìú bot_webhook.py     # Webhook –¥–ª—è–±–æ—Ç–∞
 ‚îÉ ‚îÉ ‚î£ üìú healthcheck.py     # –ü—Ä–æ–≤–µ—Ä–∫–∞ API
 ‚îÉ ‚îÉ ‚îó üìú miniapp.py         # –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã miniapp
 ‚îÉ ‚î£ üìÇ bot/                 # –õ–æ–≥–∏–∫–∞ –±–æ—Ç–∞
 ‚îÉ ‚îÉ ‚î£ üìÇ content/           # –¢–µ–∫—Å—Ç, –∫–Ω–æ–ø–∫–∏ –∏ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã –±–æ—Ç–∞
 ‚îÉ ‚îÉ ‚î£ üìÇ middleware/        # Middleware –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö –±–æ—Ç–∞
 ‚îÉ ‚îÉ ‚îó üìÇ routers/           # –†–æ—É—Ç–µ—Ä—ã –∫–æ–º–∞–Ω–¥ –±–æ—Ç–∞
 ‚îÉ ‚îÉ   ‚î£ üìÇ channel/         # –†–æ—É—Ç–µ—Ä—ã —Ä–∞–±–æ—Ç–∞—é—â–∏–µ –≤ –∫–∞–Ω–∞–ª–∞—Ö
 ‚îÉ ‚îÉ   ‚î£ üìÇ group/           # –†–æ—É—Ç–µ—Ä—ã —Ä–∞–±–æ—Ç–∞—é—â–∏–µ –≤ –≥—Ä—É–ø–ø–∞—Ö –∏ —Å—É–ø–µ—Ä–≥—Ä—É–ø–ø–∞—Ö
 ‚îÉ ‚îÉ   ‚îó üìÇ private/         # –†–æ—É—Ç–µ—Ä—ã –≤ –ª–∏—á–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏—è—Ö —Å –±–æ—Ç–æ–º
 ‚îÉ ‚î£ üìÇ assistant/           # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ –∫–ª–∞—Å—Å—ã –∏ —É—Ç–∏–ª–∏—Ç—ã
 ‚îÉ ‚î£ üìÇ frontend/            # –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤ miniapp
 ‚îÉ ‚îÉ ‚î£ üìÇ static/            # –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã
 ‚îÉ ‚îÉ ‚îÉ ‚î£ üìÇ js/              # –°–∫—Ä–∏–ø—Ç—ã
 ‚îÉ ‚îÉ ‚îÉ ‚îó üìÇ style/           # –°—Ç–∏–ª–∏ 
 ‚îÉ ‚îÉ ‚îó üìÇ templates/         # HTML-—à–∞–±–ª–æ–Ω—ã
 ‚îÉ ‚îÉ   ‚îó üìÇ pages/           # –°—Ç—Ä–∞–Ω–∏—Ü—ã
 ‚îÉ ‚î£ üìÇ conn/                # –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
 ‚îÉ ‚îÉ ‚î£ üìú engines.py         # –î–≤–∏–∂–∫–∏ –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö
 ‚îÉ ‚îÉ ‚î£ üìú sql.py             # SQL-–∑–∞–ø—Ä–æ—Å—ã
 ‚îÉ ‚îÉ ‚îó üìú tables.py          # –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü
 ‚îÉ ‚î£ üìÇ models/              # –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö
 ‚îÉ ‚îó üìú config.py            # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
 ‚î£ üìú .env                   # –§–∞–π–ª —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è
 ‚î£ üìú .env-example           # –ü—Ä–∏–º–µ–Ω .env —Ñ–∞–π–ª–∞
 ‚î£ üìú main.py                # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
 ‚î£ üìú requirements.txt       # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞
 ‚îó üìú README.md              # –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

## üöÄ –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

### 0Ô∏è‚É£ –ù–∞—Å—Ç—Ä–æ–π—Ç–µ BotFather

* –ó–∞–ø—É—Å—Ç–∏—Ç–µ @BotFather –∏ –ø—Ä–æ–ø–∏—à–∏—Ç–µ /mybots
* –ò–∑ —Å–ø–∏—Å–∫–∞ –≤—ã–±–µ—Ä–∏—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–π –±–æ—Ç
* –í—ã–±–µ—Ä–∏—Ç–µ: Bot Settings -> Configure Mini App -> Edit Mini App URL
* –£–∫–∞–∂–∏—Ç–µ URL –∏–∑ CONFIG.miniapp.path


### 1Ô∏è‚É£ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (–ª–æ–∫–∞–ª—å–Ω–æ)

```sh
pip install -r  requirements.txt
```

### 2Ô∏è‚É£ –°–æ–∑–¥–∞–π—Ç–µ `.env` —Ñ–∞–π–ª

–°–æ–∑–¥–∞–π—Ç–µ `.env` –≤ –∫–æ—Ä–Ω–µ–≤–æ–π –ø–∞–ø–∫–µ –∏ —É–∫–∞–∂–∏—Ç–µ –≤—Å–µ –¥–∞–Ω–Ω—ã–µ (–ø—Ä–∏–º–µ—Ä –Ω–∏–∂–µ):

```
HOST_IP=0.0.0.0
HOST_PORT=8000

DB_HOST=db
DB_PORT=3306
DB_NAME=bot_db
DB_USER=bot_user
DB_PASSWORD=bot_password

ALLOWED_IPS='IP,IP,IP'
```
### 3Ô∏è‚É£ –ó–∞–ø—É—Å—Ç–∏—Ç–µ `main.py` —Ñ–∞–π–ª

–£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –ø—Ä–æ–ø–∏—Å–∞–ª–∏ IP –≤–∞—à–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ –∏ —Å–µ—Ä–≤–µ—Ä–∞ —Ç–µ–ª–µ–≥—Ä–∞–º–º –¥–ª—è `ALLOWED_IPS` –≤  `.env`
